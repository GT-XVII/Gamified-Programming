<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: DefaultAwsSecurityCredentialsSupplier Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('class_default_aws_security_credentials_supplier.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_default_aws_security_credentials_supplier-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">DefaultAwsSecurityCredentialsSupplier Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for DefaultAwsSecurityCredentialsSupplier:</div>
<div class="dyncontent">
<div class="center"><img src="class_default_aws_security_credentials_supplier__coll__graph.png" border="0" usemap="#a_default_aws_security_credentials_supplier_coll__map" alt="Collaboration graph"/></div>
<map name="a_default_aws_security_credentials_supplier_coll__map" id="a_default_aws_security_credentials_supplier_coll__map">
<area shape="rect" title=" " alt="" coords="5,5,198,127"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4280acc72bb43d1dcc816e9d18a46c4c" id="r_a4280acc72bb43d1dcc816e9d18a46c4c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4280acc72bb43d1dcc816e9d18a46c4c">constructor</a> (opts)</td></tr>
<tr class="separator:a4280acc72bb43d1dcc816e9d18a46c4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bea45631a4cf154731e911859bd23ea" id="r_a1bea45631a4cf154731e911859bd23ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="util_2dist_2index_8cjs_8js.html#af516a86cc3f563f4c12f98f31f1e2e57">async</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1bea45631a4cf154731e911859bd23ea">getAwsRegion</a> (<a class="el" href="database-compat_2dist_2index_8standalone_8js.html#a2f035fcf2afcfd1521c26d73d7d9de31">context</a>)</td></tr>
<tr class="separator:a1bea45631a4cf154731e911859bd23ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad522649c499c985631eb00e3c0221320" id="r_ad522649c499c985631eb00e3c0221320"><td class="memItemLeft" align="right" valign="top"><a class="el" href="util_2dist_2index_8cjs_8js.html#af516a86cc3f563f4c12f98f31f1e2e57">async</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad522649c499c985631eb00e3c0221320">getAwsSecurityCredentials</a> (<a class="el" href="database-compat_2dist_2index_8standalone_8js.html#a2f035fcf2afcfd1521c26d73d7d9de31">context</a>)</td></tr>
<tr class="separator:ad522649c499c985631eb00e3c0221320"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Internal AWS security credentials supplier implementation used by <code><a class="el" href="class_aws_client.html">AwsClient</a></code> when a credential source is provided instead of a user defined supplier. The logic is summarized as:</p><ol type="1">
<li>If imdsv2_session_token_url is provided in the credential source, then fetch the aws session token and include it in the headers of the metadata requests. This is a requirement for IDMSv2 but optional for IDMSv1.</li>
<li>Retrieve AWS region from availability-zone. 3a. Check AWS credentials in environment variables. If not found, get from security-credentials endpoint. 3b. Get AWS credentials from security-credentials endpoint. In order to retrieve this, the AWS role needs to be determined by calling security-credentials endpoint without any argument. Then the credentials can be retrieved via: security-credentials/role_name</li>
<li>Generate the signed request to AWS STS GetCallerIdentity action.</li>
<li>Inject x-goog-cloud-target-resource into header and serialize the signed request. This will be the subject-token to pass to GCP STS. </li>
</ol>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a4280acc72bb43d1dcc816e9d18a46c4c" name="a4280acc72bb43d1dcc816e9d18a46c4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4280acc72bb43d1dcc816e9d18a46c4c">&#9670;&#160;</a></span>constructor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DefaultAwsSecurityCredentialsSupplier::constructor </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>opts</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Instantiates a new <a class="el" href="class_default_aws_security_credentials_supplier.html">DefaultAwsSecurityCredentialsSupplier</a> using information from the credential_source stored in the ADC file. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">opts</td><td>The default aws security credentials supplier options object to build the supplier with. </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="defaultawssecuritycredentialssupplier_8js.html#a47d3f52d23e71c67998a519b6a8db532">_DefaultAwsSecurityCredentialsSupplier_instances</a>.</p>

</div>
</div>
<a id="a1bea45631a4cf154731e911859bd23ea" name="a1bea45631a4cf154731e911859bd23ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bea45631a4cf154731e911859bd23ea">&#9670;&#160;</a></span>getAwsRegion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="util_2dist_2index_8cjs_8js.html#af516a86cc3f563f4c12f98f31f1e2e57">async</a> DefaultAwsSecurityCredentialsSupplier::getAwsRegion </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>context</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the active AWS region. This first checks to see if the region is available as an environment variable. If it is not, then the supplier will call the region URL. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td><code><a class="el" href="">ExternalAccountSupplierContext</a></code> from the calling <code><a class="el" href="class_aws_client.html">AwsClient</a></code>, contains the requested audience and subject token type for the external account identity. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="class_a.html">A</a> promise that resolves with the AWS region string. </dd></dl>

<p class="reference">References <a class="el" href="defaultawssecuritycredentialssupplier_8js.html#a447cd4ee0c75db2d366d333c1c6ab92b">__classPrivateFieldGet</a>, <a class="el" href="defaultawssecuritycredentialssupplier_8js.html#a3d6705c76eb60ae620d7f3b5a6dfe382">_DefaultAwsSecurityCredentialsSupplier_getImdsV2SessionToken</a>, <a class="el" href="defaultawssecuritycredentialssupplier_8js.html#a47d3f52d23e71c67998a519b6a8db532">_DefaultAwsSecurityCredentialsSupplier_instances</a>, <a class="el" href="defaultawssecuritycredentialssupplier_8js.html#a4e89ee95ab7041dcd000b3340f403d33">_DefaultAwsSecurityCredentialsSupplier_regionFromEnv_get</a>, <a class="el" href="database-compat_2dist_2index_8standalone_8js.html#a2f035fcf2afcfd1521c26d73d7d9de31">context</a>, <a class="el" href="database-compat_2dist_2index_8standalone_8js.html#a7f2cb2fcdd79bf72cefd29b7bc2d10fa">headers</a>, <a class="el" href="lodash_2method_8js.html#a2f565198b0a61cb8648a01f0d9617cd7">method</a>, <a class="el" href="database-compat_2dist_2index_8standalone_8js.html#ac70ac40ef8199c59316b35022dd21914">response</a>, and <a class="el" href="database-compat_2dist_2index_8standalone_8js.html#acf0a8b41f00a22e21672c8b3768a0618">url</a>.</p>

</div>
</div>
<a id="ad522649c499c985631eb00e3c0221320" name="ad522649c499c985631eb00e3c0221320"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad522649c499c985631eb00e3c0221320">&#9670;&#160;</a></span>getAwsSecurityCredentials()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="util_2dist_2index_8cjs_8js.html#af516a86cc3f563f4c12f98f31f1e2e57">async</a> DefaultAwsSecurityCredentialsSupplier::getAwsSecurityCredentials </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>context</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns AWS security credentials. This first checks to see if the credentials is available as environment variables. If it is not, then the supplier will call the security credentials URL. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td><code><a class="el" href="">ExternalAccountSupplierContext</a></code> from the calling <code><a class="el" href="class_aws_client.html">AwsClient</a></code>, contains the requested audience and subject token type for the external account identity. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="class_a.html">A</a> promise that resolves with the AWS security credentials. </dd></dl>

<p class="reference">References <a class="el" href="defaultawssecuritycredentialssupplier_8js.html#a447cd4ee0c75db2d366d333c1c6ab92b">__classPrivateFieldGet</a>, <a class="el" href="defaultawssecuritycredentialssupplier_8js.html#ae74e694a8c00ad9ef8552cf9fdfe3736">_DefaultAwsSecurityCredentialsSupplier_getAwsRoleName</a>, <a class="el" href="defaultawssecuritycredentialssupplier_8js.html#a3d6705c76eb60ae620d7f3b5a6dfe382">_DefaultAwsSecurityCredentialsSupplier_getImdsV2SessionToken</a>, <a class="el" href="defaultawssecuritycredentialssupplier_8js.html#a47d3f52d23e71c67998a519b6a8db532">_DefaultAwsSecurityCredentialsSupplier_instances</a>, <a class="el" href="defaultawssecuritycredentialssupplier_8js.html#a72b6c4baea3756c2271082f4bd97d41a">_DefaultAwsSecurityCredentialsSupplier_retrieveAwsSecurityCredentials</a>, <a class="el" href="defaultawssecuritycredentialssupplier_8js.html#a69bf5ec2cdadf210b8c05b2505823413">_DefaultAwsSecurityCredentialsSupplier_securityCredentialsFromEnv_get</a>, <a class="el" href="database-compat_2dist_2index_8standalone_8js.html#a2f035fcf2afcfd1521c26d73d7d9de31">context</a>, and <a class="el" href="util_2dist_2index_8cjs_8js.html#a87da3d8264af1c9427605148f20dd9c4">token</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>backend/node_modules/google-auth-library/build/src/auth/<a class="el" href="defaultawssecuritycredentialssupplier_8js.html">defaultawssecuritycredentialssupplier.js</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="class_default_aws_security_credentials_supplier.html">DefaultAwsSecurityCredentialsSupplier</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
